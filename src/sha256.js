(function() {/*
 A JavaScript implementation of the SHA family of hashes, as defined in FIPS
 PUB 180-2 as well as the corresponding HMAC implementation as defined in
 FIPS PUB 198a

 Copyright Brian Turek 2008-2012
 Distributed under the BSD License
 See http://caligatio.github.com/jsSHA/ for more information

 Several functions taken from Paul Johnson
*/
function l(a){throw a;}function n(a,b){var c=[],f=(1<<b)-1,d=a.length*b,g;for(g=0;g<d;g+=b)c[g>>>5]|=(a.charCodeAt(g/b)&f)<<32-b-g%32;return c}function s(a){var b=[],c=a.length,f,d;for(f=0;f<c;f+=2)d=parseInt(a.substr(f,2),16),isNaN(d)&&l("String of HEX type contains invalid characters"),b[f>>>3]|=d<<24-4*(f%8);return b}
function w(a,b){var c="",f=4*a.length,d,g;for(d=0;d<f;d+=1)g=a[d>>>2]>>>8*(3-d%4),c+="0123456789abcdef".charAt(g>>>4&15)+"0123456789abcdef".charAt(g&15);return b.outputUpper?c.toUpperCase():c}
function z(a,b){var c="",f=4*a.length,d,g,m;for(d=0;d<f;d+=3){m=(a[d>>>2]>>>8*(3-d%4)&255)<<16|(a[d+1>>>2]>>>8*(3-(d+1)%4)&255)<<8|a[d+2>>>2]>>>8*(3-(d+2)%4)&255;for(g=0;4>g;g+=1)c=8*d+6*g<=32*a.length?c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(m>>>6*(3-g)&63):c+b.b64Pad}return c}
function A(a){var b={outputUpper:!1,b64Pad:"="};try{a.hasOwnProperty("outputUpper")&&(b.outputUpper=a.outputUpper),a.hasOwnProperty("b64Pad")&&(b.b64Pad=a.b64Pad)}catch(c){}"boolean"!==typeof b.outputUpper&&l("Invalid outputUpper formatting option");"string"!==typeof b.b64Pad&&l("Invalid b64Pad formatting option");return b}function B(a,b){return a>>>b|a<<32-b}function C(a,b,c){return a&b^~a&c}function O(a,b,c){return a&b^a&c^b&c}function P(a){return B(a,2)^B(a,13)^B(a,22)}
function Q(a){return B(a,6)^B(a,11)^B(a,25)}function R(a){return B(a,7)^B(a,18)^a>>>3}function S(a){return B(a,17)^B(a,19)^a>>>10}function T(a,b){var c=(a&65535)+(b&65535);return((a>>>16)+(b>>>16)+(c>>>16)&65535)<<16|c&65535}function U(a,b,c,f){var d=(a&65535)+(b&65535)+(c&65535)+(f&65535);return((a>>>16)+(b>>>16)+(c>>>16)+(f>>>16)+(d>>>16)&65535)<<16|d&65535}
function V(a,b,c,f,d){var g=(a&65535)+(b&65535)+(c&65535)+(f&65535)+(d&65535);return((a>>>16)+(b>>>16)+(c>>>16)+(f>>>16)+(d>>>16)+(g>>>16)&65535)<<16|g&65535}
function W(a,b,c){var f,d,g,m,i,t,v,x,D,e,q,j,h,o,p,k,u,E,F,G,H,I,J,K,L,M,r=[],N,y;"SHA-224"===c||"SHA-256"===c?(q=64,o=16,p=1,L=Number,k=T,u=U,E=V,F=R,G=S,H=P,I=Q,K=O,J=C,M=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,
338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],e="SHA-224"===c?[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]:[1779033703,3144134277,1013904242,2773480762,
1359893119,2600822924,528734635,1541459225]):l("Unexpected error in SHA-2 implementation");a[b>>>5]|=128<<24-b%32;a[(b+65>>>9<<4)+15]=b;N=a.length;for(j=0;j<N;j+=o){b=e[0];f=e[1];d=e[2];g=e[3];m=e[4];i=e[5];t=e[6];v=e[7];for(h=0;h<q;h+=1)r[h]=16>h?new L(a[h*p+j],a[h*p+j+1]):u(G(r[h-2]),r[h-7],F(r[h-15]),r[h-16]),x=E(v,I(m),J(m,i,t),M[h],r[h]),D=k(H(b),K(b,f,d)),v=t,t=i,i=m,m=k(g,x),g=d,d=f,f=b,b=k(x,D);e[0]=k(b,e[0]);e[1]=k(f,e[1]);e[2]=k(d,e[2]);e[3]=k(g,e[3]);e[4]=k(m,e[4]);e[5]=k(i,e[5]);e[6]=
k(t,e[6]);e[7]=k(v,e[7])}"SHA-224"===c?y=[e[0],e[1],e[2],e[3],e[4],e[5],e[6]]:"SHA-256"===c?y=e:l("Unexpected error in SHA-2 implementation");return y}
window.jsSHA=function(a,b,c){var f=null,d=null,g=0,m=[0],i=0,i="undefined"!==typeof c?c:8;8===i||16===i||l("charSize must be 8 or 16");"HEX"===b?(0!==a.length%2&&l("srcString of HEX type must be in byte increments"),g=4*a.length,m=s(a)):"ASCII"===b||"TEXT"===b?(g=a.length*i,m=n(a,i)):l("inputFormat must be HEX, TEXT, or ASCII");this.getHash=function(a,b,c){var i=null,e=m.slice(),q="";switch(b){case "HEX":i=w;break;case "B64":i=z;break;default:l("format must be HEX or B64")}if("SHA-224"===a){null===
f&&(f=W(e,g,a));q=i(f,A(c))}else if("SHA-256"===a){null===d&&(d=W(e,g,a));q=i(d,A(c))}else l("Chosen SHA variant is not supported");return q};this.getHMAC=function(a,b,c,d,e){var f,j,h,o,p,k=[],u=[];switch(d){case "HEX":f=w;break;case "B64":f=z;break;default:l("outputFormat must be HEX or B64")}if("SHA-224"===c){h=64;p=224}else if("SHA-256"===c){h=64;p=256}else l("Chosen SHA variant is not supported");if("HEX"===b){0!==a.length%2&&l("key of HEX type must be in byte increments");j=s(a);o=a.length*
4}else if("ASCII"===b||"TEXT"===b){j=n(a,i);o=a.length*i}else l("inputFormat must be HEX, TEXT or ASCII");a=h*8;b=h/4-1;if(h<o/8){j=W(j,o,c);j[b]=j[b]&4294967040}else h>o/8&&(j[b]=j[b]&4294967040);for(h=0;h<=b;h=h+1){k[h]=j[h]^909522486;u[h]=j[h]^1549556828}c=W(u.concat(W(k.concat(m),a+g,c)),a+p,c);return f(c,A(e))}};})();
