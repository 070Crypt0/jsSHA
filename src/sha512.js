/*
 A JavaScript implementation of the SHA family of hashes, as
 defined in FIPS PUB 180-2 as well as the corresponding HMAC implementation
 as defined in FIPS PUB 198a

 Copyright Brian Turek 2008-2015
 Distributed under the BSD License
 See http://caligatio.github.com/jsSHA/ for more information

 Several functions taken from Paul Johnston
*/
'use strict';(function(I){function w(q,c,a){var b=0,f=[],e=0,g,k,l,m,n,u,r,p=!1,h=[],t=[],v,z=!1;a=a||{};g=a.encoding||"UTF8";v=a.numRounds||1;l=A(c,g);if(v!==parseInt(v,10)||1>v)throw Error("numRounds must a integer >= 1");u=function(c,a){return B(c,a,q)};r=function(c,a,d,e){var f,b;if("SHA-384"===q||"SHA-512"===q)f=(a+129>>>10<<5)+31,b=32;else throw Error("Unexpected error in SHA-2 implementation");for(;c.length<=f;)c.push(0);c[a>>>5]|=128<<24-a%32;c[f]=a+d;d=c.length;for(a=0;a<d;a+=b)e=B(c.slice(a,
a+b),e,q);if("SHA-384"===q)c=[e[0].a,e[0].b,e[1].a,e[1].b,e[2].a,e[2].b,e[3].a,e[3].b,e[4].a,e[4].b,e[5].a,e[5].b];else if("SHA-512"===q)c=[e[0].a,e[0].b,e[1].a,e[1].b,e[2].a,e[2].b,e[3].a,e[3].b,e[4].a,e[4].b,e[5].a,e[5].b,e[6].a,e[6].b,e[7].a,e[7].b];else throw Error("Unexpected error in SHA-2 implementation");return c};if("SHA-384"===q)n=1024,m=384;else if("SHA-512"===q)n=1024,m=512;else throw Error("Chosen SHA variant is not supported");k=x(q);this.setHMACKey=function(c,a,d){var e;if(!0===p)throw Error("HMAC key already set");
if(!0===z)throw Error("Cannot set HMAC key after calling update");g=(d||{}).encoding||"UTF8";a=A(a,g)(c);c=a.binLen;a=a.value;e=n>>>3;d=e/4-1;if(e<c/8){for(a=r(a,c,0,x(q));a.length<=d;)a.push(0);a[d]&=4294967040}else if(e>c/8){for(;a.length<=d;)a.push(0);a[d]&=4294967040}for(c=0;c<=d;c+=1)h[c]=a[c]^909522486,t[c]=a[c]^1549556828;k=u(h,k);b=n;p=!0};this.update=function(c){var a,q,d,g=0,m=n>>>5;a=l(c,f,e);c=a.binLen;q=a.value;a=c>>>5;for(d=0;d<a;d+=m)g+n<=c&&(k=u(q.slice(d,d+m),k),g+=n);b+=g;f=q.slice(g>>>
5);e=c%n;z=!0};this.getHash=function(c,a){var d,g,n,l;if(!0===p)throw Error("Cannot call getHash after setting HMAC key");n=C(a);switch(c){case "HEX":d=function(c){return D(c,n)};break;case "B64":d=function(c){return E(c,n)};break;case "BYTES":d=F;break;default:throw Error("format must be HEX, B64, or BYTES");}l=r(f.slice(),e,b,k.slice());for(g=1;g<v;g+=1)l=r(l,m,0,x(q));return d(l)};this.getHMAC=function(c,a){var d,g,l,h;if(!1===p)throw Error("Cannot call getHMAC without first setting HMAC key");
l=C(a);switch(c){case "HEX":d=function(c){return D(c,l)};break;case "B64":d=function(c){return E(c,l)};break;case "BYTES":d=F;break;default:throw Error("outputFormat must be HEX, B64, or BYTES");}g=r(f.slice(),e,b,k.slice());h=u(t,x(q));h=r(g,m,n,h);return d(h)}}function a(a,c){this.a=a;this.b=c}function J(a,c,d){var b=a.length,f,e,g,k,l;c=c||[0];d=d||0;l=d>>>3;if(0!==b%2)throw Error("String of HEX type must be in byte increments");for(f=0;f<b;f+=2){e=parseInt(a.substr(f,2),16);if(isNaN(e))throw Error("String of HEX type contains invalid characters");
k=(f>>>1)+l;for(g=k>>>2;c.length<=g;)c.push(0);c[g]|=e<<8*(3-k%4)}return{value:c,binLen:4*b+d}}function K(a,c,d){var b=[],f,e,g,k,b=c||[0];d=d||0;e=d>>>3;for(f=0;f<a.length;f+=1)c=a.charCodeAt(f),k=f+e,g=k>>>2,b.length<=g&&b.push(0),b[g]|=c<<8*(3-k%4);return{value:b,binLen:8*a.length+d}}function L(a,c,d){var b=[],f=0,e,g,k,l,m,n,b=c||[0];d=d||0;c=d>>>3;if(-1===a.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");g=a.indexOf("=");a=a.replace(/\=/g,"");if(-1!==g&&g<a.length)throw Error("Invalid '=' found in base-64 string");
for(g=0;g<a.length;g+=4){m=a.substr(g,4);for(k=l=0;k<m.length;k+=1)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(m[k]),l|=e<<18-6*k;for(k=0;k<m.length-1;k+=1){n=f+c;for(e=n>>>2;b.length<=e;)b.push(0);b[e]|=(l>>>16-8*k&255)<<8*(3-n%4);f+=1}}return{value:b,binLen:8*f+d}}function D(a,c){var d="",b=4*a.length,f,e;for(f=0;f<b;f+=1)e=a[f>>>2]>>>8*(3-f%4),d+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(e&15);return c.outputUpper?d.toUpperCase():d}function E(a,
c){var d="",b=4*a.length,f,e,g;for(f=0;f<b;f+=3)for(g=f+1>>>2,e=a.length<=g?0:a[g],g=f+2>>>2,g=a.length<=g?0:a[g],g=(a[f>>>2]>>>8*(3-f%4)&255)<<16|(e>>>8*(3-(f+1)%4)&255)<<8|g>>>8*(3-(f+2)%4)&255,e=0;4>e;e+=1)8*f+6*e<=32*a.length?d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>>6*(3-e)&63):d+=c.b64Pad;return d}function F(a){var c="",d=4*a.length,b,f;for(b=0;b<d;b+=1)f=a[b>>>2]>>>8*(3-b%4)&255,c+=String.fromCharCode(f);return c}function C(a){var c={outputUpper:!1,b64Pad:"="};
a=a||{};c.outputUpper=a.outputUpper||!1;!0===a.hasOwnProperty("b64Pad")&&(c.b64Pad=a.b64Pad);if("boolean"!==typeof c.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!==typeof c.b64Pad)throw Error("Invalid b64Pad formatting option");return c}function A(a,c){var d;switch(c){case "UTF8":case "UTF16BE":case "UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE");}switch(a){case "HEX":d=J;break;case "TEXT":d=function(a,d,e){var b=[],q=[],l=0,m,n,h,
r,p,b=d||[0];d=e||0;h=d>>>3;if("UTF8"===c)for(m=0;m<a.length;m+=1)for(e=a.charCodeAt(m),q=[],128>e?q.push(e):2048>e?(q.push(192|e>>>6),q.push(128|e&63)):55296>e||57344<=e?q.push(224|e>>>12,128|e>>>6&63,128|e&63):(m+=1,e=65536+((e&1023)<<10|a.charCodeAt(m)&1023),q.push(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|e&63)),n=0;n<q.length;n+=1){p=l+h;for(r=p>>>2;b.length<=r;)b.push(0);b[r]|=q[n]<<8*(3-p%4);l+=1}else if("UTF16BE"===c||"UTF16LE"===c)for(m=0;m<a.length;m+=1){e=a.charCodeAt(m);"UTF16LE"===c&&
(n=e&255,e=n<<8|e>>>8);p=l+h;for(r=p>>>2;b.length<=r;)b.push(0);b[r]|=e<<8*(2-p%4);l+=2}return{value:b,binLen:8*l+d}};break;case "B64":d=L;break;case "BYTES":d=K;break;default:throw Error("format must be HEX, TEXT, B64, or BYTES");}return d}function h(b,c){var d=null,d=new a(b.a,b.b);return d=32>=c?new a(d.a>>>c|d.b<<32-c&4294967295,d.b>>>c|d.a<<32-c&4294967295):new a(d.b>>>c-32|d.a<<64-c&4294967295,d.a>>>c-32|d.b<<64-c&4294967295)}function G(b,c){var d=null;return d=32>=c?new a(b.a>>>c,b.b>>>c|b.a<<
32-c&4294967295):new a(0,b.a>>>c-32)}function M(b,c,d){return new a(b.a&c.a^~b.a&d.a,b.b&c.b^~b.b&d.b)}function N(b,c,d){return new a(b.a&c.a^b.a&d.a^c.a&d.a,b.b&c.b^b.b&d.b^c.b&d.b)}function O(b){var c=h(b,28),d=h(b,34);b=h(b,39);return new a(c.a^d.a^b.a,c.b^d.b^b.b)}function P(b){var c=h(b,14),d=h(b,18);b=h(b,41);return new a(c.a^d.a^b.a,c.b^d.b^b.b)}function Q(b){var c=h(b,1),d=h(b,8);b=G(b,7);return new a(c.a^d.a^b.a,c.b^d.b^b.b)}function R(b){var c=h(b,19),d=h(b,61);b=G(b,6);return new a(c.a^
d.a^b.a,c.b^d.b^b.b)}function S(b,c){var d,h,f;d=(b.b&65535)+(c.b&65535);h=(b.b>>>16)+(c.b>>>16)+(d>>>16);f=(h&65535)<<16|d&65535;d=(b.a&65535)+(c.a&65535)+(h>>>16);h=(b.a>>>16)+(c.a>>>16)+(d>>>16);return new a((h&65535)<<16|d&65535,f)}function T(b,c,d,h){var f,e,g;f=(b.b&65535)+(c.b&65535)+(d.b&65535)+(h.b&65535);e=(b.b>>>16)+(c.b>>>16)+(d.b>>>16)+(h.b>>>16)+(f>>>16);g=(e&65535)<<16|f&65535;f=(b.a&65535)+(c.a&65535)+(d.a&65535)+(h.a&65535)+(e>>>16);e=(b.a>>>16)+(c.a>>>16)+(d.a>>>16)+(h.a>>>16)+(f>>>
16);return new a((e&65535)<<16|f&65535,g)}function U(b,c,d,h,f){var e,g,k;e=(b.b&65535)+(c.b&65535)+(d.b&65535)+(h.b&65535)+(f.b&65535);g=(b.b>>>16)+(c.b>>>16)+(d.b>>>16)+(h.b>>>16)+(f.b>>>16)+(e>>>16);k=(g&65535)<<16|e&65535;e=(b.a&65535)+(c.a&65535)+(d.a&65535)+(h.a&65535)+(f.a&65535)+(g>>>16);g=(b.a>>>16)+(c.a>>>16)+(d.a>>>16)+(h.a>>>16)+(f.a>>>16)+(e>>>16);return new a((g&65535)<<16|e&65535,k)}function x(b){var c,d;c=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,
3204075428];d=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];switch(b){case "SHA-224":b=c;break;case "SHA-256":b=d;break;case "SHA-384":b=[new a(3418070365,c[0]),new a(1654270250,c[1]),new a(2438529370,c[2]),new a(355462360,c[3]),new a(1731405415,c[4]),new a(41048885895,c[5]),new a(3675008525,c[6]),new a(1203062813,c[7])];break;case "SHA-512":b=[new a(d[0],4089235720),new a(d[1],2227873595),new a(d[2],4271175723),new a(d[3],1595750129),new a(d[4],2917565137),
new a(d[5],725511199),new a(d[6],4215389547),new a(d[7],327033209)];break;default:throw Error("Unknown SHA variant");}return b}function B(b,c,d){var h,f,e,g,k,l,m,n,u,r,p,w,t,v,z,x,A,B,C,D,E,F,y=[],G;if("SHA-384"===d||"SHA-512"===d)r=80,w=2,F=a,t=S,v=T,z=U,x=Q,A=R,B=O,C=P,E=N,D=M,G=H;else throw Error("Unexpected error in SHA-2 implementation");d=c[0];h=c[1];f=c[2];e=c[3];g=c[4];k=c[5];l=c[6];m=c[7];for(p=0;p<r;p+=1)16>p?(u=p*w,n=b.length<=u?0:b[u],u=b.length<=u+1?0:b[u+1],y[p]=new F(n,u)):y[p]=v(A(y[p-
2]),y[p-7],x(y[p-15]),y[p-16]),n=z(m,C(g),D(g,k,l),G[p],y[p]),u=t(B(d),E(d,h,f)),m=l,l=k,k=g,g=t(e,n),e=f,f=h,h=d,d=t(n,u);c[0]=t(d,c[0]);c[1]=t(h,c[1]);c[2]=t(f,c[2]);c[3]=t(e,c[3]);c[4]=t(g,c[4]);c[5]=t(k,c[5]);c[6]=t(l,c[6]);c[7]=t(m,c[7]);return c}var b,H;b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,
1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];H=[new a(b[0],3609767458),new a(b[1],602891725),new a(b[2],
3964484399),new a(b[3],2173295548),new a(b[4],4081628472),new a(b[5],3053834265),new a(b[6],2937671579),new a(b[7],3664609560),new a(b[8],2734883394),new a(b[9],1164996542),new a(b[10],1323610764),new a(b[11],3590304994),new a(b[12],4068182383),new a(b[13],991336113),new a(b[14],633803317),new a(b[15],3479774868),new a(b[16],2666613458),new a(b[17],944711139),new a(b[18],2341262773),new a(b[19],2007800933),new a(b[20],1495990901),new a(b[21],1856431235),new a(b[22],3175218132),new a(b[23],2198950837),
new a(b[24],3999719339),new a(b[25],766784016),new a(b[26],2566594879),new a(b[27],3203337956),new a(b[28],1034457026),new a(b[29],2466948901),new a(b[30],3758326383),new a(b[31],168717936),new a(b[32],1188179964),new a(b[33],1546045734),new a(b[34],1522805485),new a(b[35],2643833823),new a(b[36],2343527390),new a(b[37],1014477480),new a(b[38],1206759142),new a(b[39],344077627),new a(b[40],1290863460),new a(b[41],3158454273),new a(b[42],3505952657),new a(b[43],106217008),new a(b[44],3606008344),new a(b[45],
1432725776),new a(b[46],1467031594),new a(b[47],851169720),new a(b[48],3100823752),new a(b[49],1363258195),new a(b[50],3750685593),new a(b[51],3785050280),new a(b[52],3318307427),new a(b[53],3812723403),new a(b[54],2003034995),new a(b[55],3602036899),new a(b[56],1575990012),new a(b[57],1125592928),new a(b[58],2716904306),new a(b[59],442776044),new a(b[60],593698344),new a(b[61],3733110249),new a(b[62],2999351573),new a(b[63],3815920427),new a(3391569614,3928383900),new a(3515267271,566280711),new a(3940187606,
3454069534),new a(4118630271,4000239992),new a(116418474,1914138554),new a(174292421,2731055270),new a(289380356,3203993006),new a(460393269,320620315),new a(685471733,587496836),new a(852142971,1086792851),new a(1017036298,365543100),new a(1126000580,2618297676),new a(1288033470,3409855158),new a(1501505948,4234509866),new a(1607167915,987167468),new a(1816402316,1246189591)];"function"===typeof define&&define.amd?define(function(){return w}):"undefined"!==typeof exports?"undefined"!==typeof module&&
module.exports?module.exports=exports=w:exports=w:I.jsSHA=w})(this);
